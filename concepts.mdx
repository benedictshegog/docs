---
title: "Concepts"
description: "Key terms and definitions for the ESNA Data Upload API"
---

## ESNA

**Exempt Supplier Notification Agent** - The designated agent responsible for submitting generation and consumption data to the Settlement Administration Agent (SAA) on behalf of exempt electricity suppliers. Granular Energy acts as your ESNA agent.

## LES Contract

**License Exempt Supply Contract** - An agreement that links generators (supply) with consumers (demand) for license exempt supply arrangements. LES contracts define which metering points participate in local matching and settlement.

## Portfolios

### Demand Portfolio

A collection of **consumers** and their associated metering points. Each consumer represents a demand-side entity (e.g., a building, business, or site) that consumes electricity.

- Upload via the **Platform UI** at `/import/portfolio-data` → Consumption meters portfolio, or via **API** at `/portfolio/demand/upload`
- Download via `/portfolio/demand/download`
- Requires `BMUnitIdentifier` tag and `metering_point_grid_identifier` (MPAN) for ESNA submissions
- **Note:** For ESNA organisations, consumers must be created via CSV upload (not manually in the UI) because the UI does not yet support adding required tags

### Supply Portfolio

A collection of **generators** (production devices) and their associated metering points. Each generator represents a supply-side entity (e.g., a solar farm, wind turbine, or other generation asset).

- Upload via the **Platform UI** at `/import/portfolio-data` → Production devices portfolio, or via **API** at `/portfolio/supply/upload`
- Download via `/portfolio/supply/download`
- Requires `production_device_bm_unit_identifier` (BMU) and `metering_point_grid_identifier` (MPAN) for ESNA organisations

## BMU Identifier

**Balancing Mechanism Unit Identifier** - A unique identifier for balancing mechanism units in Great Britain's electricity market. Required for ESNA organisations.

**Format:** Must match the pattern `2__[GSP Group ID][alphanumeric]`:
- Starts with literal `2__` prefix
- Followed by a GSP Group ID: letters **A-H, J-N, or P** (letters I and O are excluded)
- Followed by alphanumeric characters

**Valid examples:**
- `2__ASITE001`
- `2__GFARM456`
- `2__PWIND123`

**Invalid examples:**
- `2__ISITE001` (I is not a valid GSP Group ID)
- `2__OWIND123` (O is not a valid GSP Group ID)
- `3__ASITE001` (wrong prefix)

For demand portfolios, this is provided via the `BMUnitIdentifier` column. For supply portfolios, use `production_device_bm_unit_identifier`.

## MPAN

**Metering Point Administration Number** - The official identifier for a metering point on the electricity network in Great Britain. In the API, this is referred to as `metering_point_grid_identifier`. Required for ESNA organisations.

**Format:** Must be exactly **21 characters** with the following structure:
- Positions 1-5: Profile + MTC (5 digits)
- Positions 6-8: LLF Class (3 alphanumeric characters, may include spaces but not all spaces)
- Positions 9-21: Distributor + Unique ID + Check digit (13 digits)

**Example:** `00000AL11234567890123`

<Note>
ESNA requires full 21-character MPANs to extract the LLF Class for DLF (Distribution Loss Factor) lookups. The older 13-digit format is not accepted.
</Note>

## Settlement Runs

Settlement runs are the periodic processes where generation and consumption data is reconciled. Each run type represents a different stage in the settlement timeline:

| Run | Name | Timing |
|-----|------|--------|
| **SF** | Settlement Final | +17 working days after settlement date |
| **R1** | First Reconciliation | +35 working days |
| **R2** | Second Reconciliation | +80 working days |
| **R3** | Third Reconciliation | +14 months |
| **DF** | Dispute Final | Final reconciliation |

You can track submission deadlines via the [Expected Upload Calendar](/api-reference/endpoint/get-esna-expected-upload-calendar) endpoint.

## Granularity

The time resolution of metering data. Specified using ISO 8601 duration format.

**For ESNA, granularity is always `PT30M` (30 minutes)** to align with the standard UK settlement period.

| Value | Duration |
|-------|----------|
| `PT5M` | 5 minutes |
| `PT15M` | 15 minutes |
| `PT30M` | 30 minutes (ESNA / UK settlement period) |
| `PT1H` | 1 hour |
| `P1D` | 1 day |
| `P1M` | 1 month |

## Allocation

The process of matching supply (generation) with demand (consumption) within a settlement period. Allocations are calculated by Granular Energy based on your uploaded metering data and contract configurations.

- **Unadjusted allocations** - Raw allocation volumes before any adjustments, available via `/esna/unadjusted-allocations`
- Used for Ofgem reporting requirements

## File Processing Status

When you upload a file, it goes through several processing stages:

| Status | Description |
|--------|-------------|
| `UPLOADED` | File received by Granular |
| `STORED` | File stored and ready for processing |
| `QUEUED` | File in processing queue |
| `PROCESSING` | Validation in progress |
| `NOT_COMPLIANT` | Validation failed (see `errors` field) |
| `SUCCESSFUL` | Data saved to platform |
| `FAILED` | Processing error occurred |

Use `isProcessingFinished` and `isProcessingSuccessful` flags to determine file status in your application logic.
